<div class="markdown-editor" [class.fullscreen]="isFullscreen()">
    <!-- Toolbar -->
    <div class="editor-toolbar">
        <div class="toolbar-group">
            <button
                *ngFor="let action of toolbarActions"
                type="button"
                class="toolbar-btn"
                [title]="action.label + (action.shortcut ? ' (' + action.shortcut + ')' : '')"
                (click)="action.action()"
            >
                <span class="toolbar-icon">{{ action.icon }}</span>
            </button>
        </div>
        
        <div class="toolbar-group">
            <button
                type="button"
                class="toolbar-btn"
                [class.active]="viewMode() === 'split'"
                title="Vista dividida"
                (click)="setViewMode('split')"
            >
                <span class="toolbar-icon">ğŸ“</span>
            </button>
            <button
                type="button"
                class="toolbar-btn"
                [class.active]="viewMode() === 'edit'"
                title="Solo editor"
                (click)="setViewMode('edit')"
            >
                <span class="toolbar-icon">âœï¸</span>
            </button>
            <button
                type="button"
                class="toolbar-btn"
                [class.active]="viewMode() === 'preview'"
                title="Solo preview"
                (click)="setViewMode('preview')"
            >
                <span class="toolbar-icon">ğŸ‘ï¸</span>
            </button>
            <button
                type="button"
                class="toolbar-btn"
                [class.active]="isFullscreen()"
                title="Pantalla completa (F11)"
                (click)="toggleFullscreen()"
            >
                <span class="toolbar-icon">{{ isFullscreen() ? 'ğŸ——' : 'ğŸ—–' }}</span>
            </button>
        </div>
        
        <div class="toolbar-info">
            <span class="save-indicator saving" *ngIf="isSaving()">ğŸ’¾ Guardando...</span>
            <span class="save-indicator unsaved" *ngIf="!isSaving() && hasChanges()">â— Sin guardar</span>
            <span class="save-indicator saved" *ngIf="!isSaving() && !hasChanges()">âœ“ Guardado</span>
            <span class="word-count">{{ wordCount() }} palabras Â· {{ readTime() }} min</span>
        </div>
    </div>
    
    <!-- Editor Container -->
    <div class="editor-container" [class.view-mode]="viewMode()">
        <!-- Editor Panel -->
        <div class="editor-panel"
             *ngIf="viewMode() !== 'preview'"
             (dragover)="onDragOver($event)"
             (dragleave)="onDragLeave($event)"
             (drop)="onDrop($event)"
             [class.drag-over]="isDragging()">
            
            <div class="line-numbers" #lineNumbers>
                <span class="line-number" *ngFor="let line of lineNumbersArray()">{{ line }}</span>
            </div>
            
            <textarea
                #editorTextarea
                class="editor-textarea"
                [value]="content()"
                (input)="onContentChange($event)"
                (keydown)="onKeyDown($event)"
                (scroll)="syncScroll($event)"
                (paste)="onPaste($event)"
                [placeholder]="placeholder"
                spellcheck="false"
            ></textarea>
            
            <div class="drop-overlay" *ngIf="isDragging()">
                <span class="drop-icon">ğŸ“·</span>
                <span class="drop-text">Suelta la imagen aquÃ­</span>
            </div>
        </div>
        
        <!-- Preview Panel -->
        <div class="preview-panel" *ngIf="viewMode() !== 'edit'" #previewPanel>
            <div class="preview-loading" *ngIf="isRendering()">
                <span class="loading-spinner">â³</span>
                <span>Renderizando...</span>
            </div>
            <div 
                class="preview-content markdown-body"
                *ngIf="!isRendering()"
                [innerHTML]="renderedHtml()"
            ></div>
        </div>
    </div>
    
    <!-- Status Bar -->
    <div class="editor-statusbar">
        <div class="status-left">
            <span class="status-item">LÃ­nea {{ cursorLine() }}, Col {{ cursorColumn() }}</span>
            <span class="status-item languages" *ngIf="languagesUsed().length > 0">
                Lenguajes: {{ languagesUsed().join(', ') }}
            </span>
        </div>
        <div class="status-right">
            <span class="status-item">Markdown</span>
        </div>
    </div>
</div>
