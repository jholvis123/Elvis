<div class="min-h-screen bg-background py-12 px-4">
  <div class="max-w-4xl mx-auto">
    <!-- Header -->
    <div class="text-center mb-12">
      <h1 class="text-4xl md:text-5xl font-bold text-white mb-4">
        ğŸ† Leaderboard
      </h1>
      <p class="text-textSecondary text-lg">Ranking de los mejores hackers por puntos de CTF</p>
    </div>

    <!-- My Stats Card (if logged in) -->
    <div *ngIf="myStats" class="bg-gradient-to-r from-primary/10 to-primary/5 backdrop-blur-lg rounded-xl border border-primary/30 p-6 mb-8">
      <div class="flex flex-col md:flex-row items-center justify-between gap-4">
        <div class="flex items-center gap-4">
          <div class="w-16 h-16 rounded-full bg-gradient-to-r from-primary to-cyan-400 flex items-center justify-center text-2xl font-bold text-background">
            {{ myStats.rank || '?' }}
          </div>
          <div>
            <h3 class="text-xl font-bold text-white">{{ myStats.username }}</h3>
            <p class="text-textSecondary">Tu posiciÃ³n en el ranking</p>
          </div>
        </div>
        <div class="flex gap-6 text-center">
          <div>
            <p class="text-3xl font-bold text-primary">{{ myStats.total_points }}</p>
            <p class="text-textSecondary text-sm">Puntos</p>
          </div>
          <div>
            <p class="text-3xl font-bold text-primary/80">{{ myStats.solved_count }}</p>
            <p class="text-textSecondary text-sm">CTFs Resueltos</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="loading" class="flex justify-center py-12">
      <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-primary"></div>
    </div>

    <!-- Leaderboard Table -->
    <div *ngIf="!loading" class="bg-white/5 backdrop-blur-lg rounded-xl border border-white/10 overflow-hidden">
      <!-- Top 3 Podium -->
      <div *ngIf="leaderboard.length >= 3" class="p-8 bg-gradient-to-b from-primary/10 to-transparent">
        <div class="flex justify-center items-end gap-4">
          <!-- 2nd Place -->
          <ng-container *ngIf="leaderboard[1] as second">
            <div class="text-center transform hover:scale-105 transition">
              <div class="w-20 h-20 mx-auto mb-2 rounded-full bg-gradient-to-r from-gray-400 to-gray-300 flex items-center justify-center">
                <span class="text-3xl">ğŸ¥ˆ</span>
              </div>
              <p class="text-white font-bold">{{ second.username }}</p>
              <p class="text-primary font-semibold">{{ second.total_points }} pts</p>
              <p class="text-gray-500 text-sm">{{ second.solved_count }} CTFs</p>
            </div>
          </ng-container>
          
          <!-- 1st Place -->
          <ng-container *ngIf="leaderboard[0] as first">
            <div class="text-center transform hover:scale-105 transition -mt-4">
              <div class="w-24 h-24 mx-auto mb-2 rounded-full bg-gradient-to-r from-primary to-cyan-400 flex items-center justify-center shadow-lg shadow-primary/30">
                <span class="text-4xl">ğŸ‘‘</span>
              </div>
              <p class="text-white font-bold text-lg">{{ first.username }}</p>
              <p class="text-primary font-semibold text-xl">{{ first.total_points }} pts</p>
              <p class="text-gray-500 text-sm">{{ first.solved_count }} CTFs</p>
            </div>
          </ng-container>
          
          <!-- 3rd Place -->
          <ng-container *ngIf="leaderboard[2] as third">
            <div class="text-center transform hover:scale-105 transition">
              <div class="w-20 h-20 mx-auto mb-2 rounded-full bg-gradient-to-r from-amber-600 to-amber-500 flex items-center justify-center">
                <span class="text-3xl">ğŸ¥‰</span>
              </div>
              <p class="text-white font-bold">{{ third.username }}</p>
              <p class="text-primary font-semibold">{{ third.total_points }} pts</p>
              <p class="text-gray-500 text-sm">{{ third.solved_count }} CTFs</p>
            </div>
          </ng-container>
        </div>
      </div>

      <!-- Full Table -->
      <table class="w-full">
        <thead class="bg-white/10">
          <tr>
            <th class="text-center px-6 py-4 text-white font-semibold w-20">Rank</th>
            <th class="text-left px-6 py-4 text-white font-semibold">Usuario</th>
            <th class="text-center px-6 py-4 text-white font-semibold">Puntos</th>
            <th class="text-center px-6 py-4 text-white font-semibold">CTFs Resueltos</th>
          </tr>
        </thead>
        <tbody>
          <tr 
            *ngFor="let entry of leaderboard; let i = index" 
            class="border-t border-white/10 hover:bg-white/5 transition"
            [ngClass]="{
              'bg-yellow-500/10': entry.rank === 1,
              'bg-gray-400/10': entry.rank === 2,
              'bg-amber-600/10': entry.rank === 3,
              'bg-blue-500/10': myStats && entry.user_id === myStats.user_id
            }">
            <td class="px-6 py-4 text-center">
              <span 
                class="inline-flex items-center justify-center w-10 h-10 rounded-full font-bold"
                [ngClass]="{
                  'bg-primary text-background': entry.rank === 1,
                  'bg-primary/70 text-background': entry.rank === 2,
                  'bg-primary/50 text-background': entry.rank === 3,
                  'bg-white/20 text-white': entry.rank > 3
                }">
                {{ entry.rank }}
              </span>
            </td>
            <td class="px-6 py-4">
              <a 
                [routerLink]="['/ctf/leaderboard/user', entry.user_id]"
                class="text-white font-medium hover:text-primary transition flex items-center gap-2"
              >
                <span *ngIf="entry.rank === 1">ğŸ‘‘</span>
                <span *ngIf="entry.rank === 2">ğŸ¥ˆ</span>
                <span *ngIf="entry.rank === 3">ğŸ¥‰</span>
                {{ entry.username }}
                <span *ngIf="myStats && entry.user_id === myStats.user_id" class="text-primary text-sm">(TÃº)</span>
              </a>
            </td>
            <td class="px-6 py-4 text-center">
              <span class="text-primary font-bold text-lg">{{ entry.total_points }}</span>
            </td>
            <td class="px-6 py-4 text-center">
              <span class="text-primary/80">{{ entry.solved_count }}</span>
            </td>
          </tr>
          <tr *ngIf="leaderboard.length === 0">
            <td colspan="4" class="px-6 py-12 text-center text-gray-500">
              <div class="flex flex-col items-center gap-4">
                <span class="text-4xl">ğŸ¯</span>
                <p>No hay jugadores en el ranking todavÃ­a</p>
                <a routerLink="/ctf" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition">
                  Resolver tu primer CTF
                </a>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Legend / Info -->
    <div class="mt-8 text-center text-gray-500 text-sm">
      <p>ğŸ’¡ Los puntos se otorgan al resolver CTFs correctamente. Â¡Resuelve mÃ¡s para subir en el ranking!</p>
    </div>
  </div>
</div>
